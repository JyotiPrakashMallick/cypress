def clearWorkspace() {
stage("Cleaning Workspace for Cypress Automation") {
deleteDir()
}
}

def npminstall() {
stage("npm install") {
sh 'npm install'
}
}

def npmruntestcases() {
stage("npm runtestcases") {
sh 'npm run cypress:run'
}
}

def checkout() {
stage 'Checkout'
clearWorkspace()
checkout([$class: 'GitSCM',
branches: [[name: '*/dev_FinalStaging']],
doGenerateSubmoduleConfigurations: false,
extensions: [],
submoduleCfg: [],
userRemoteConfigs: [[credentialsId: 'cicarecru_github', url: 'https://github.com/CareCru/qa-e2e-automations.git']]])
}

node('jenkins-slave') {
try {
clearWorkspace()
checkout()
npminstall()
npmruntestcases()
currentBuild.result = "SUCCESS"
} catch (Exception err) {
println(err)
currentBuild.result = "FAILURE"
}
}
